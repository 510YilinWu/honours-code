# rename all .png files in a directory. 
# Read them in alphabetical order and rename as 
import os
import glob


# for subject 6  onward
def rename_files(directory):
    # Get all .png files in the directory    
    files = sorted(
        glob.glob(os.path.join(directory, '*.png')),
        key=lambda x: (
            int(os.path.basename(x).split('_')[2].split('.')[0]),
            os.path.basename(x).split('_')[1]
        )
    )

    # Initialize counters for left and right images
    counters = {}

    for file in files:
        # Extract the camera and number from the filename
        parts = os.path.basename(file).split('_') 
        subject = parts[0]               # 'AAB'
        camera = parts[1]                    # 'cam0'
        number = int(parts[2].split('.')[0]) # '06.png' → 6
        index = files.index(file)

        # Determine if the image is for the right or left hand based on the index
        current_hand = 'right' if (index // 2) % 2 == 0 else 'left'

        # Initialize counter for this camera if not already done
        if camera not in counters:
            counters[camera] = {'left': 1, 'right': 1}

        # Generate the new name
        new_name = f"{current_hand}_{subject}_{camera}_{counters[camera][current_hand]:02d}.png"
        counters[camera][current_hand] += 1
        # Initialize counter for this camera if not already done
        # if camera not in counters:
        #     counters[camera] = 1

        # # Generate the new name
        # new_name = f"{current_hand}_{subject}_{camera}_{counters[camera]:02d}.png"
        # counters[camera] += 1


        # Construct full path for the new file name
        new_file_path = os.path.join(directory, new_name)

        # Rename the file
        os.rename(file, new_file_path)
        print(f'Renamed "{file}" to "{new_file_path}"')

# # for first 5 subjects, the files named differ.
# def rename_files(directory):
#     # Ask for the subject name as input
#     subject = input("Enter the subject name: ")

#     # Get all .png files in the directory    
#     files = sorted(
#         glob.glob(os.path.join(directory, '*.png')),
#         key=lambda x: (
#             int(os.path.basename(x).split('_')[1].split('.')[0]),
#             os.path.basename(x).split('_')[0]
#         )
#     )

#     # Initialize counters for left and right images
#     counters = {}

#     for file in files:
#         # Extract the camera and number from the filename
#         parts = os.path.basename(file).split('_') 
#         camera = parts[0]                    # 'cam0'
#         number = int(parts[1].split('.')[0]) # '06.png' → 6
#         index = files.index(file)

#         # Determine if the image is for the right or left hand based on the index
#         # current_hand = 'right' if (index // 2) % 2 == 0 else 'left'
#         current_hand = 'right' if (index // 4) % 2 == 0 else 'left'


#         # Initialize counter for this camera if not already done
#         if camera not in counters:
#             counters[camera] = {'left': 1, 'right': 1}

#         # Generate the new name
#         new_name = f"{current_hand}_{subject}_{camera}_{counters[camera][current_hand]:02d}.png"
#         counters[camera][current_hand] += 1

#         # Construct full path for the new file name
#         new_file_path = os.path.join(directory, new_name)

#         # Rename the file
#         os.rename(file, new_file_path)
#         print(f'Renamed "{file}" to "{new_file_path}"')


if __name__ == "__main__":
    # Specify the directory containing the .jpg files
    # directory = '/Volumes/MNHS-MoCap/Yilin-Honours/tBBT_Image/2025/06/19/1 copy 2'  # Change this to your directory path
    directory = '/Users/yilinwu/Desktop/Yilin-Honours/tBBT_Image/2025/06/19/CZ copy'
    # directory = '/Users/yilinwu/Desktop/Yilin-Honours/tBBT_Image/2025/06/19/1 copy'
    rename_files(directory)

